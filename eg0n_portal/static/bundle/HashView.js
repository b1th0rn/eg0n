import{_ as g,c,w as d,d as m,o as p,a as o,b as h}from"./eg0nPortal.js";import{_ as f,a as S,b as P}from"./SearchBar.js";import{e as _}from"./eg0nApiServices.js";const b={name:"VulnView",data(){return{hashSearch:{text:"",pageNumber:1,perPage:10,sortBy:"publish_date",sortOrder:"asc"},items:[],totalHashs:0,fieldsConfiguration:[],showDetails:!1,hashSelected:{}}},mounted(){this.fieldsConfiguration=[{key:"filename",sortable:!0},{key:"platform",sortable:!1},{key:"md5",sortable:!1},{key:"publish_date",sortable:!0},{key:"author",sortable:!0}],this.search()},methods:{async search(){var e=await _.GetHashs(this.hashSearch);this.currentPage=e.data.current_page,this.totalHashs=e.data.total_items,this.items=e.data.hash_list},changeSort(e){this.sort=e,this.changePage(1)},openHashDetails(e){this.hashSelected=e.item,this.showDetails=!0,console.log("doppio click su una riga della tabella",e)},closeVulnDetails(){this.showDetails=!1},changePerPage(e){this.perPage=e,this.changePage(1)},changePage(e){this.currentPage=e,this.search()},changeSearchText(e){this.searchText=e,this.changePage(1)}},computed:{searchText:{get(){return this.hashSearch.text},set(e){this.hashSearch.text=e}},currentPage:{get(){return this.hashSearch.pageNumber},set(e){this.hashSearch.pageNumber=e}},sort:{get(){return this.hashSearch.sortBy},set(e){this.hashSearch.sortBy=e.key,this.hashSearch.sortOrder=e.order?e.order:"asc"}},defaultSortBy:{get(){let e=this.hashSearch.sortBy?this.hashSearch.sortBy:"publish_date",t=this.hashSearch.sortOrder?this.hashSearch.sortOrder:"asc";return[{key:e,order:t}]}},perPage:{get(){return this.hashSearch.perPage},set(e){this.hashSearch.perPage=e}},hashs:{get(){return this.items}},total:{get(){return this.totalHashs}}}};function y(e,t,C,D,r,a){const n=f,l=S,i=P,u=m;return p(),c(u,null,{default:d(()=>[t[7]||(t[7]=o("h1",null,"Welcome on Hash page",-1)),t[8]||(t[8]=o("span",{class:"mb-2 mt-2"},"This page show a list of hash find by our validtor and contributor, you can use a search bar to filter result",-1)),h(n,{onChangeText:t[0]||(t[0]=s=>a.changeSearchText(s)),onEmitSearch:t[1]||(t[1]=s=>a.search())}),h(l,{items:a.hashs,fieldsConfiguration:r.fieldsConfiguration,currentPage:a.currentPage,perPageValue:a.perPage,totalVulns:a.total,defaultSort:a.defaultSortBy,onChangePage:t[2]||(t[2]=s=>a.changePage(s)),onChangePerPage:t[3]||(t[3]=s=>a.changePerPage(s)),onChangeSort:t[4]||(t[4]=s=>a.changeSort(s)),onRowDblClicked:t[5]||(t[5]=s=>a.openHashDetails(s))},null,8,["items","fieldsConfiguration","currentPage","perPageValue","totalVulns","defaultSort"]),h(i,{showDetails:r.showDetails,vuln:r.hashSelected,onCloseDescription:t[6]||(t[6]=s=>a.closeVulnDetails(s))},null,8,["showDetails","vuln"])]),_:1})}const w=g(b,[["render",y]]);export{w as default};
