import{e as b,t as k,r as L,u as W,f as M,i as E,g as H,h as J,j as Q,k as X,l as Y,n as Z,m as K,p as ee,q as U,s as te,v as ae,x as D,o as y,y as o,z as R,c as N,w as d,A as S,B as q,b as P,C as T,D as ne,E as oe,F as se,_ as F,d as h,G as le,H as re,I as ue,J as A,K as ie,L as G,M as de,N as ce,a as O,O as pe}from"./eg0nPortal.js";const me=(e,n)=>b(()=>{const a=k(e),t=k(n);return a===!0?"true":typeof a=="string"?a:t===!1?"true":a===!1?"false":void 0}),fe=e=>b(()=>{const n=k(e);return n===!0?"is-valid":n===!1?"is-invalid":null}),_e=(e,n)=>{if(e===null)return;let a=e;if(n.number&&typeof a=="string"&&a!==""){const t=Number.parseFloat(a);a=Number.isNaN(t)?a:t}return a},ve=(e,n,a,t)=>{var c;const s=L(0),r=W(()=>e.id,"input"),f=M(()=>e.debounce??0),v=M(()=>e.debounceMaxWait??NaN),u=(c=E(H,null))==null?void 0:c(r),i=b(()=>e.state!==void 0?e.state:(u==null?void 0:u.state.value)??null),_=me(()=>e.ariaInvalid,i),z=fe(i),w=J(l=>{a.value=l},()=>t.lazy===!0?0:f.value,{maxWait:()=>t.lazy===!0?NaN:v.value}),C=(l,g=!1)=>{t.lazy===!0&&g===!1||w(l)},{focused:V}=Q(n,{initialValue:e.autofocus}),$=(l,g,m=!1)=>e.formatter!==void 0&&(!e.lazyFormatter||m)?e.formatter(l,g):l;return X(()=>{var l;n.value&&(n.value.value=((l=a.value)==null?void 0:l.toString())??"")}),Y(()=>{Z(()=>{e.autofocus&&(V.value=!0)})}),{input:n,computedId:r,computedAriaInvalid:_,onInput:l=>{const{value:g}=l.target,m=$(g,l);if(l.defaultPrevented){l.preventDefault();return}C(m)},onChange:l=>{const{value:g}=l.target,m=$(g,l);if(l.defaultPrevented){l.preventDefault();return}const I=m;a.value!==I&&C(m,!0)},onBlur:l=>{if(!t.lazy&&!e.lazyFormatter&&!t.trim)return;const{value:g}=l.target,m=$(g,l,!0),I=t.trim?m.trim():m,j=I.length!==m.length;a.value!==I&&C(m,!0),t.trim&&j&&(s.value=s.value+1)},focus:()=>{e.disabled||(V.value=!0)},blur:()=>{e.disabled||(V.value=!1)},forceUpdateKey:s,stateClass:z}},ge=["id","value","name","form","type","disabled","placeholder","required","autocomplete","readonly","min","max","step","list","aria-required","aria-invalid"],he=K({__name:"BFormInput",props:ee({max:{default:void 0},min:{default:void 0},step:{default:void 0},type:{default:"text"},ariaInvalid:{type:[Boolean,String],default:void 0},autocomplete:{default:void 0},autofocus:{type:Boolean,default:!1},disabled:{type:Boolean,default:!1},form:{default:void 0},formatter:{type:Function,default:void 0},id:{default:void 0},lazyFormatter:{type:Boolean,default:!1},list:{default:void 0},name:{default:void 0},placeholder:{default:void 0},plaintext:{type:Boolean,default:!1},readonly:{type:Boolean,default:!1},required:{type:Boolean,default:!1},size:{default:void 0},state:{type:[Boolean,null],default:void 0},debounce:{default:0},debounceMaxWait:{default:NaN}},{modelValue:{default:""},modelModifiers:{}}),emits:["update:modelValue"],setup(e,{expose:n}){const t=U(e,"BFormInput"),[c,s]=te(e,"modelValue",{set:x=>_e(x,s)}),r=ae("_input"),{computedId:f,computedAriaInvalid:v,onInput:u,onChange:i,onBlur:_,stateClass:z,focus:w,blur:C,forceUpdateKey:V}=ve(t,r,c,s),$=b(()=>{const x=t.type==="range",p=t.type==="color";return[z.value,{"form-range":x,"form-control":p||!t.plaintext&&!x,"form-control-color":p,"form-control-plaintext":t.plaintext&&!x&&!p,[`form-control-${t.size}`]:!!t.size}]});return n({blur:C,element:r,focus:w}),(x,p)=>(y(),D("input",{id:o(f),ref:"_input",key:o(V),value:o(c),class:R($.value),name:o(t).name||void 0,form:o(t).form||void 0,type:o(t).type,disabled:o(t).disabled,placeholder:o(t).placeholder,required:o(t).required||void 0,autocomplete:o(t).autocomplete||void 0,readonly:o(t).readonly||o(t).plaintext,min:o(t).min,max:o(t).max,step:o(t).step,list:o(t).type!=="password"?o(t).list:void 0,"aria-required":o(t).required||void 0,"aria-invalid":o(v),onInput:p[0]||(p[0]=(...B)=>o(u)&&o(u)(...B)),onChange:p[1]||(p[1]=(...B)=>o(i)&&o(i)(...B)),onBlur:p[2]||(p[2]=(...B)=>o(_)&&o(_)(...B))},null,42,ge))}}),ye={key:0,class:"input-group-text"},xe={key:0,class:"input-group-text"},be=K({__name:"BInputGroup",props:{append:{default:void 0},id:{default:void 0},prepend:{default:void 0},size:{default:"md"},tag:{default:"div"}},setup(e){oe(se,!0);const a=U(e,"BInputGroup"),t=b(()=>({[`input-group-${a.size}`]:a.size!=="md"})),c=b(()=>!!a.append),s=b(()=>!!a.prepend);return(r,f)=>(y(),N(ne(o(a).tag),{id:o(a).id,class:R(["input-group",t.value]),role:"group"},{default:d(()=>[S(r.$slots,"prepend",{},()=>[s.value?(y(),D("span",ye,[P("span",null,T(o(a).prepend),1)])):q("",!0)]),S(r.$slots,"default"),S(r.$slots,"append",{},()=>[c.value?(y(),D("span",xe,[P("span",null,T(o(a).append),1)])):q("",!0)])]),_:3},8,["id","class"]))}}),Be={name:"Details",props:{showDetails:Boolean,vuln:Object},mounted(){console.log("mounted vulnDetails")},methods:{capitalizeKey(e){return e=e[0].toUpperCase()+e.slice(1),e.replace("_"," ")}},computed:{showPanel:{get(){return this.showDetails},set(e){this.$emit("closeDescription")}}}};function Ce(e,n,a,t,c,s){const r=ie,f=A,v=le,u=de;return y(),N(u,{modelValue:s.showPanel,"onUpdate:modelValue":n[0]||(n[0]=i=>s.showPanel=i),title:"Vuln Description",placement:"end",shodow:"false"},{default:d(()=>[h(v,null,{default:d(()=>[(y(!0),D(re,null,ue(Object.entries(a.vuln),([i,_])=>(y(),N(f,{class:"my-1"},{default:d(()=>[h(r,{cols:"4"},{default:d(()=>[G(T(s.capitalizeKey(i))+":",1)]),_:2},1024),h(r,{cols:"8"},{default:d(()=>[G(T(_),1)]),_:2},1024),n[1]||(n[1]=P("hr",{class:"hr"},null,-1))]),_:2,__:[1]},1024))),256))]),_:1})]),_:1},8,["modelValue"])}const ze=F(Be,[["render",Ce]]),Ve={name:"VulnTable",props:{items:Array,fieldsConfiguration:Array,currentPage:Number,totalVulns:Number,perPageValue:10,defaultSort:Array},mounted(){},methods:{sort(e){this.$emit("changeSort",e)},rowDblClicked(e,n,a){let t={item:e,index:n,event:a};this.$emit("rowDblClicked",t)}},computed:{perPageOptions(){return[2,25,50,75,100]},perPage:{get(){return this.perPageValue},set(e){this.$emit("changePerPage",e)}},curPage:{get(){return this.currentPage&&this.currentPage==0?1:this.currentPage},set(e){this.$emit("changePage",e)}},vulnsList:{get(){return this.items}}}};function $e(e,n,a,t,c,s){const r=A,f=ce,v=O;return y(),N(v,null,{default:d(()=>[h(r),h(f,{items:s.vulnsList,fields:a.fieldsConfiguration,"sort-by":a.defaultSort,multisort:"false","no-local-sorting":"true","per-page":s.perPage,sorted:s.sort,onRowDblclicked:n[0]||(n[0]=(u,i,_)=>{s.rowDblClicked(u,i,_)}),onSorted:n[1]||(n[1]=u=>s.sort(u))},null,8,["items","fields","sort-by","per-page","sorted"])]),_:1})}const we=F(Ve,[["render",$e]]),Ie={name:"SearchBar",data(){return{searchText:"",searchTimer:null,searchDelay:2e3}},methods:{emitChangeText(){this.$emit("changeText",this.searchText)},emitSearch(){this.$emit("emitSearch")}},computed:{text:{get(){return this.searchText},set(e){this.searchText=e,this.searchTimer&&clearTimeout(this.searchTimer),this.searchTimer=setTimeout(()=>{this.emitChangeText()},this.searchDelay)}}}};function Ne(e,n,a,t,c,s){const r=pe,f=he,v=be,u=A,i=O;return y(),N(i,null,{default:d(()=>[h(u,null,{default:d(()=>[h(v,{class:"mt-3 mb-3"},{append:d(()=>[h(r,{variant:"outline-secondary",onClick:s.emitSearch},{default:d(()=>n[1]||(n[1]=[P("span",{class:"material-icons"},"search",-1)])),_:1,__:[1]},8,["onClick"])]),default:d(()=>[h(f,{modelValue:s.text,"onUpdate:modelValue":n[0]||(n[0]=_=>s.text=_)},null,8,["modelValue"])]),_:1})]),_:1})]),_:1})}const Se=F(Ie,[["render",Ne]]);export{Se as _,we as a,ze as b};
