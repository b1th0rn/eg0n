import{e as b,t as T,r as j,u as L,f as A,i as W,g as E,h as H,j as J,k as Q,l as X,n as Y,m as K,p as Z,q as U,s as ee,v as te,x as $,o as y,y as o,z as G,c as V,w as c,A as D,B as M,b as I,C as N,D as ae,E as ne,F as oe,_ as z,d as h,G as se,H as le,I as re,J as w,K as ue,L as q,M as ie,N as de,a as O,O as ce}from"./eg0nPortal.js";const pe=(e,n)=>b(()=>{const a=T(e),t=T(n);return a===!0?"true":typeof a=="string"?a:t===!1?"true":a===!1?"false":void 0}),me=e=>b(()=>{const n=T(e);return n===!0?"is-valid":n===!1?"is-invalid":null}),fe=(e,n)=>{if(e===null)return;let a=e;if(n.number&&typeof a=="string"&&a!==""){const t=Number.parseFloat(a);a=Number.isNaN(t)?a:t}return a},_e=(e,n,a,t)=>{var p;const l=j(0),r=L(()=>e.id,"input"),_=A(()=>e.debounce??0),v=A(()=>e.debounceMaxWait??NaN);(p=W(E,null))==null||p(r);const i=H(s=>{a.value=s},()=>t.lazy===!0?0:_.value,{maxWait:()=>t.lazy===!0?NaN:v.value}),u=(s,g=!1)=>{t.lazy===!0&&g===!1||i(s)},{focused:d}=J(n,{initialValue:e.autofocus}),B=(s,g,f=!1)=>e.formatter!==void 0&&(!e.lazyFormatter||f)?e.formatter(s,g):s;Q(()=>{var s;n.value&&(n.value.value=((s=a.value)==null?void 0:s.toString())??"")}),X(()=>{Y(()=>{e.autofocus&&(d.value=!0)})});const P=pe(()=>e.ariaInvalid,()=>e.state);return{input:n,computedId:r,computedAriaInvalid:P,onInput:s=>{const{value:g}=s.target,f=B(g,s);if(s.defaultPrevented){s.preventDefault();return}u(f)},onChange:s=>{const{value:g}=s.target,f=B(g,s);if(s.defaultPrevented){s.preventDefault();return}const C=f;a.value!==C&&u(f,!0)},onBlur:s=>{if(!t.lazy&&!e.lazyFormatter&&!t.trim)return;const{value:g}=s.target,f=B(g,s,!0),C=t.trim?f.trim():f,R=C.length!==f.length;a.value!==C&&u(f,!0),t.trim&&R&&(l.value=l.value+1)},focus:()=>{e.disabled||(d.value=!0)},blur:()=>{e.disabled||(d.value=!1)},forceUpdateKey:l}},ve=["id","value","name","form","type","disabled","placeholder","required","autocomplete","readonly","min","max","step","list","aria-required","aria-invalid"],ge=K({__name:"BFormInput",props:Z({max:{default:void 0},min:{default:void 0},step:{default:void 0},type:{default:"text"},ariaInvalid:{type:[Boolean,String],default:void 0},autocomplete:{default:void 0},autofocus:{type:Boolean,default:!1},disabled:{type:Boolean,default:!1},form:{default:void 0},formatter:{type:Function,default:void 0},id:{default:void 0},lazyFormatter:{type:Boolean,default:!1},list:{default:void 0},name:{default:void 0},placeholder:{default:void 0},plaintext:{type:Boolean,default:!1},readonly:{type:Boolean,default:!1},required:{type:Boolean,default:!1},size:{default:void 0},state:{type:[Boolean,null],default:null},debounce:{default:0},debounceMaxWait:{default:NaN}},{modelValue:{default:""},modelModifiers:{}}),emits:["update:modelValue"],setup(e,{expose:n}){const t=U(e,"BFormInput"),[p,l]=ee(e,"modelValue",{set:x=>fe(x,l)}),r=te("_input"),{computedId:_,computedAriaInvalid:v,onInput:i,onChange:u,onBlur:d,focus:B,blur:P,forceUpdateKey:k}=_e(t,r,p,l),F=me(()=>t.state),S=b(()=>{const x=t.type==="range",m=t.type==="color";return[F.value,{"form-range":x,"form-control":m||!t.plaintext&&!x,"form-control-color":m,"form-control-plaintext":t.plaintext&&!x&&!m,[`form-control-${t.size}`]:!!t.size}]});return n({blur:P,element:r,focus:B}),(x,m)=>(y(),$("input",{id:o(_),ref:"_input",key:o(k),value:o(p),class:G(S.value),name:o(t).name||void 0,form:o(t).form||void 0,type:o(t).type,disabled:o(t).disabled,placeholder:o(t).placeholder,required:o(t).required||void 0,autocomplete:o(t).autocomplete||void 0,readonly:o(t).readonly||o(t).plaintext,min:o(t).min,max:o(t).max,step:o(t).step,list:o(t).type!=="password"?o(t).list:void 0,"aria-required":o(t).required||void 0,"aria-invalid":o(v),onInput:m[0]||(m[0]=(...s)=>o(i)&&o(i)(...s)),onChange:m[1]||(m[1]=(...s)=>o(u)&&o(u)(...s)),onBlur:m[2]||(m[2]=(...s)=>o(d)&&o(d)(...s))},null,42,ve))}}),he={key:0,class:"input-group-text"},ye={key:0,class:"input-group-text"},xe=K({__name:"BInputGroup",props:{append:{default:void 0},id:{default:void 0},prepend:{default:void 0},size:{default:"md"},tag:{default:"div"}},setup(e){ne(oe,!0);const a=U(e,"BInputGroup"),t=b(()=>({[`input-group-${a.size}`]:a.size!=="md"})),p=b(()=>!!a.append),l=b(()=>!!a.prepend);return(r,_)=>(y(),V(ae(o(a).tag),{id:o(a).id,class:G(["input-group",t.value]),role:"group"},{default:c(()=>[D(r.$slots,"prepend",{},()=>[l.value?(y(),$("span",he,[I("span",null,N(o(a).prepend),1)])):M("",!0)]),D(r.$slots,"default"),D(r.$slots,"append",{},()=>[p.value?(y(),$("span",ye,[I("span",null,N(o(a).append),1)])):M("",!0)])]),_:3},8,["id","class"]))}}),be={name:"Details",props:{showDetails:Boolean,vuln:Object},mounted(){console.log("mounted vulnDetails")},methods:{capitalizeKey(e){return e=e[0].toUpperCase()+e.slice(1),e.replace("_"," ")}},computed:{showPanel:{get(){return this.showDetails},set(e){this.$emit("closeDescription")}}}};function Be(e,n,a,t,p,l){const r=ue,_=w,v=se,i=ie;return y(),V(i,{modelValue:l.showPanel,"onUpdate:modelValue":n[0]||(n[0]=u=>l.showPanel=u),title:"Vuln Description",placement:"end",shodow:"false"},{default:c(()=>[h(v,null,{default:c(()=>[(y(!0),$(le,null,re(Object.entries(a.vuln),([u,d])=>(y(),V(_,{class:"my-1"},{default:c(()=>[h(r,{cols:"4"},{default:c(()=>[q(N(l.capitalizeKey(u))+":",1)]),_:2},1024),h(r,{cols:"8"},{default:c(()=>[q(N(d),1)]),_:2},1024),n[1]||(n[1]=I("hr",{class:"hr"},null,-1))]),_:2},1024))),256))]),_:1})]),_:1},8,["modelValue"])}const Pe=z(be,[["render",Be]]),Ce={name:"VulnTable",props:{items:Array,fieldsConfiguration:Array,currentPage:Number,totalVulns:Number,perPageValue:10,defaultSort:Array},mounted(){},methods:{sort(e){this.$emit("changeSort",e)},rowDblClicked(e,n,a){let t={item:e,index:n,event:a};this.$emit("rowDblClicked",t)}},computed:{perPageOptions(){return[2,25,50,75,100]},perPage:{get(){return this.perPageValue},set(e){this.$emit("changePerPage",e)}},curPage:{get(){return this.currentPage&&this.currentPage==0?1:this.currentPage},set(e){this.$emit("changePage",e)}},vulnsList:{get(){return this.items}}}};function Ve(e,n,a,t,p,l){const r=w,_=de,v=O;return y(),V(v,null,{default:c(()=>[h(r),h(_,{items:l.vulnsList,fields:a.fieldsConfiguration,"sort-by":a.defaultSort,multisort:"false","no-local-sorting":"true","per-page":l.perPage,sorted:l.sort,onRowDblclicked:n[0]||(n[0]=(i,u,d)=>{l.rowDblClicked(i,u,d)}),onSorted:n[1]||(n[1]=i=>l.sort(i))},null,8,["items","fields","sort-by","per-page","sorted"])]),_:1})}const De=z(Ce,[["render",Ve]]),$e={name:"SearchBar",data(){return{searchText:"",searchTimer:null,searchDelay:2e3}},methods:{emitChangeText(){this.$emit("changeText",this.searchText)},emitSearch(){this.$emit("emitSearch")}},computed:{text:{get(){return this.searchText},set(e){this.searchText=e,this.searchTimer&&clearTimeout(this.searchTimer),this.searchTimer=setTimeout(()=>{this.emitChangeText()},this.searchDelay)}}}};function Ie(e,n,a,t,p,l){const r=ce,_=ge,v=xe,i=w,u=O;return y(),V(u,null,{default:c(()=>[h(i,null,{default:c(()=>[h(v,{class:"mt-3 mb-3"},{append:c(()=>[h(r,{variant:"outline-secondary",onClick:l.emitSearch},{default:c(()=>n[1]||(n[1]=[I("span",{class:"material-icons"},"search",-1)])),_:1},8,["onClick"])]),default:c(()=>[h(_,{modelValue:l.text,"onUpdate:modelValue":n[0]||(n[0]=d=>l.text=d)},null,8,["modelValue"])]),_:1})]),_:1})]),_:1})}const Te=z($e,[["render",Ie]]);export{Te as _,De as a,Pe as b};
