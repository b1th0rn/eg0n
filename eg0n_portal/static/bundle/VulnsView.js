import{_ as g,c,o as d,w as m,a as l,b as n,d as p}from"./eg0nPortal.js";import{_ as f,a as v,b as S}from"./SearchBar.js";import{e as P}from"./eg0nApiServices.js";const b={name:"VulnView",data(){return{vulnSearch:{text:"",pageNumber:1,perPage:10,sortBy:"publish_date",sortOrder:"asc"},items:[],totalVulns:0,fieldsConfiguration:[],showDetails:!1,vulnSelected:{}}},mounted(){this.fieldsConfiguration=[{key:"cve",sortable:!1},{key:"name",sortable:!1},{key:"cvss",sortable:!0},{key:"publish_date",sortable:!0},{key:"author",sortable:!0}],this.search()},methods:{async search(){var e=await P.GetVulns(this.vulnSearch);this.currentPage=e.data.current_page,this.totalVulns=e.data.total_items,this.items=e.data.vulnerabilities},changeSort(e){this.sort=e,this.changePage(1)},openVulnDetails(e){this.vulnSelected=e.item,this.showDetails=!0,console.log("doppio click su una riga della tabella",e)},closeVulnDetails(){this.showDetails=!1},changePerPage(e){this.perPage=e,this.changePage(1)},changePage(e){this.currentPage=e,this.search()},changeSearchText(e){this.searchText=e,this.changePage(1)}},computed:{searchText:{get(){return this.vulnSearch.text},set(e){this.vulnSearch.text=e}},currentPage:{get(){return this.vulnSearch.pageNumber},set(e){this.vulnSearch.pageNumber=e}},sort:{get(){return this.VulnSearch.sortBy},set(e){this.vulnSearch.sortBy=e.key,this.vulnSearch.sortOrder=e.order?e.order:"asc"}},defaultSortBy:{get(){let e=this.vulnSearch.sortBy?this.vulnSearch.sortBy:"publish_date",t=this.vulnSearch.sortOrder?this.vulnSearch.sortOrder:"asc";return[{key:e,order:t}]}},perPage:{get(){return this.vulnSearch.perPage},set(e){this.vulnSearch.perPage=e}},vulns:{get(){return this.items}},total:{get(){return this.totalVulns}}}};function _(e,t,V,y,a,r){const o=f,u=v,i=S,h=p;return d(),c(h,null,{default:m(()=>[t[7]||(t[7]=l("h1",null,"Welcome on vulns page",-1)),t[8]||(t[8]=l("span",{class:"mb-2 mt-2"},"This page show a list of vuls find by our validtor anc contributor, you can use a search bar to filter result by desciption",-1)),n(o,{onChangeText:t[0]||(t[0]=s=>r.changeSearchText(s)),onEmitSearch:t[1]||(t[1]=s=>r.search())}),n(u,{items:r.vulns,fieldsConfiguration:a.fieldsConfiguration,currentPage:r.currentPage,perPageValue:r.perPage,totalVulns:r.total,defaultSort:r.defaultSortBy,onChangePage:t[2]||(t[2]=s=>r.changePage(s)),onChangePerPage:t[3]||(t[3]=s=>r.changePerPage(s)),onChangeSort:t[4]||(t[4]=s=>r.changeSort(s)),onRowDblClicked:t[5]||(t[5]=s=>r.openVulnDetails(s))},null,8,["items","fieldsConfiguration","currentPage","perPageValue","totalVulns","defaultSort"]),n(i,{showDetails:a.showDetails,vuln:a.vulnSelected,onCloseDescription:t[6]||(t[6]=s=>r.closeVulnDetails(s))},null,8,["showDetails","vuln"])]),_:1})}const x=g(b,[["render",_]]);export{x as default};
